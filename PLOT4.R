## ASSIGNMENT
## THE OVERALL GOAL OF THIS ASSIGNMENT IS TO EXPLORE THE NATIONAL EMMISIONS INVENTORY
## DATABASE AND SEE WHAT IT SAYS ABOUT PARTICULATE MATTER POLLUTION IN THE UNITED STATES
## OVER A TEN YEAR PERIOD 1999-2008. MAKE RELEVANT PLOTS IN ORDER TO ANSWER THE QUESTIONS.

## READ IN THE 2 RDS SUPPLIED FOR THE PROJECT

## IN THE USA, HOW HAVE EMISSIONS FROM COAL-COMBUSTION RELATED SOURCES CHANGED DURING 1999-2008?
## ANSWER: A GRADUAL DECREASE DURING THIS PERIOD WITH NO UPTICKS OR SPIKES.

NEI <- readRDS("~/DS mod4 wk4 proj/exdata_data_NEI_data/summarySCC_PM25.rds")
SCC<- readRDS("~/DS mod4 wk4 proj/exdata_data_NEI_data/Source_Classification_Code.rds")

NEISCC <- merge(NEI, SCC, by="SCC")

# HOW HAVE EMISSIONS FROM COAL COMBUSTION RELATED CHANGED FROM 1998 TO 2008 IN THE USA

# FETCH ALL NEI&SCC WITH SHORT.NAME (SCC) COAL
COALMATCH  <- grepl("coal", NEISCC$Short.Name, ignore.case=TRUE)AGGDATA
NEISCCPARSE <- NEISCC[COALMATCH, ]
##  AGGREGATE DATA AND SUM BY YEAR
AGGDATA <- aggregate(Emissions ~ year, NEISCCPARSE, sum)

png("PLOT4.png")

barplot(height=AGGDATA$Emissions, names.arg=AGGDATA$year, xlab="Year", 
        ylab=expression('Total Coal emission'),col ="dark orange",
        main=expression('Total USA emissions generated by coal at various years'))

dev.off()